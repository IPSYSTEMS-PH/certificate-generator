<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Webinar, Partner Training, and Other Certificates Generator (Mass Volume) Beta</title>
    <!-- <link href="assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" /> -->
    <link href="assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,500;0,600;0,700;1,600;1,700&family=Source+Sans+Pro:ital,wght@0,400;0,600;1,400&display=swap"
        rel="stylesheet" />
</head>

<body>
    <div class="d-flex flex-column-fluid align-items-start container-xxl">
        <div class="content flex-row-fluid py-10">
            <div class="form d-flex flex-column flex-lg-row fv-plugins-bootstrap5 fv-plugins-framework"
                id="certificate-form" name="certificate-form">
                <div class="d-flex flex-column flex-row-fluid gap-7 gap-lg-10">
                    <div class="d-flex flex-column gap-7 gap-lg-10">
                        <div class="card card-flush py-4">
                            <div class="card-header">
                                <div class="card-title">
                                    <h1>Webinar, Partner Training, and Other Certificates Generator (Mass Volume) <span
                                            class="badge badge-secondary">Beta</span></h1>
                                </div>
                            </div>
                            <div class="card-body pt-0">
                                <h2 class="mb-10 mt-10">Attendee Details</h2>
                                <form id="add-data-form">
                                    <div class="mb-5 fv-row">
                                        <div class="d-flex flex-wrap gap-5">
                                            <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                                <label class="required form-label">Name of Attendee:</label>
                                                <input type="text" name="attendee_name" id="attendee_name"
                                                    class="form-control mb-2"
                                                    placeholder="Enter the full name of the attendee here" />
                                                <div class="text-muted fs-7">Please enter the full name of the attendee
                                                    who will receive the certificate. e.g Jethro Jorolan</div>
                                                <div class="fv-plugins-message-container invalid-feedback"></div>
                                            </div>
                                            <div class="fv-row w-100 flex-md-root">

                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-5 fv-row">
                                        <div class="d-flex flex-wrap gap-5">
                                            <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                                <label class="required form-label">Organization
                                                    Name:</label>
                                                <input type="text" name="organization" id="organization"
                                                    class="form-control mb-2"
                                                    placeholder="Enter the name of the company"
                                                    value="IPSYSTEMS, Inc." />
                                                <div class="text-muted fs-7">Please enter the name of the company e.g.
                                                    IPSYSTEMS, Inc.</div>
                                                <div class="fv-plugins-message-container invalid-feedback"></div>
                                            </div>
                                            <div class="fv-row w-100 flex-md-root">

                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-5 fv-row">
                                        <div class="d-flex flex-wrap gap-5">
                                            <div class="fv-row w-100 flex-md-root">
                                                <button class="btn btn-primary" id="add-row" name="add-row">
                                                    <span class="indicator-label">Add to Table</span>
                                                    <span class="indicator-progress">
                                                        Please wait...
                                                        <span
                                                            class="spinner-border spinner-border-sm align-middle ms-2"></span>
                                                    </span>
                                                </button>
                                            </div>

                                        </div>
                                    </div>
                                </form>
                                <div class="mb-5 fv-row">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                            <div class="card card-p-0 card-flush">
                                                <div class="card-header align-items-center py-5 gap-2 gap-md-5">
                                                    <div class="card-title">
                                                        <!--begin::Search-->
                                                        <div class="d-flex align-items-center position-relative my-1">
                                                            <span
                                                                class="svg-icon fs-1 position-absolute ms-4">...</span>
                                                            <input type="text" data-kt-filter="search"
                                                                class="form-control form-control-solid w-250px ps-14"
                                                                placeholder="Search Report" />
                                                        </div>
                                                        <!--end::Search-->
                                                        <!--begin::Export buttons-->
                                                        <div id="kt_datatable_example_1_export" class="d-none"></div>
                                                        <!--end::Export buttons-->
                                                    </div>
                                                    <div class="card-toolbar flex-row-fluid justify-content-end gap-5">
                                                        <!--begin::Export dropdown-->
                                                        <button type="button" class="btn btn-light-primary disabled"
                                                            data-kt-menu-trigger="click"
                                                            data-kt-menu-placement="bottom-end" disabled>
                                                            <i class="ki-duotone ki-exit-down fs-2"><span
                                                                    class="path1"></span><span class="path2"></span></i>
                                                            Export Report
                                                        </button>
                                                        <!--begin::Menu-->
                                                        <div id="kt_datatable_example_export_menu"
                                                            class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-semibold fs-7 w-200px py-4"
                                                            data-kt-menu="true">
                                                            <!--begin::Menu item-->
                                                            <div class="menu-item px-3">
                                                                <a href="#" class="menu-link px-3"
                                                                    data-kt-export="copy">
                                                                    Copy to clipboard
                                                                </a>
                                                            </div>
                                                            <!--end::Menu item-->
                                                            <!--begin::Menu item-->
                                                            <div class="menu-item px-3">
                                                                <a href="#" class="menu-link px-3"
                                                                    data-kt-export="excel">
                                                                    Export as Excel
                                                                </a>
                                                            </div>
                                                            <!--end::Menu item-->
                                                            <!--begin::Menu item-->
                                                            <div class="menu-item px-3">
                                                                <a href="#" class="menu-link px-3" data-kt-export="csv">
                                                                    Export as CSV
                                                                </a>
                                                            </div>
                                                            <!--end::Menu item-->
                                                            <!--begin::Menu item-->
                                                            <div class="menu-item px-3">
                                                                <a href="#" class="menu-link px-3" data-kt-export="pdf">
                                                                    Export as PDF
                                                                </a>
                                                            </div>
                                                            <!--end::Menu item-->
                                                        </div>
                                                        <!--end::Menu-->
                                                        <!--end::Export dropdown-->

                                                        <!--begin::Hide default export buttons-->
                                                        <div id="kt_datatable_example_buttons" class="d-none"></div>
                                                        <!--end::Hide default export buttons-->
                                                    </div>
                                                </div>
                                                <div class="card-body">
                                                    <table
                                                        class="table align-middle table-row-dashed fs-6 gy-5 dataTable no-footer"
                                                        id="kt_ecommerce_products_table">
                                                        <thead>
                                                            <tr
                                                                class="text-start text-gray-400 fw-bold fs-7 text-uppercase gs-0">
                                                                <th class="min-w-70px">
                                                                    ID</th>
                                                                <th class="min-w-100px"
                                                                    aria-label="Name: activate to sort column ascending">
                                                                    Name</th>
                                                                <th class="min-w-100px"
                                                                    aria-label="Organization Name: activate to sort column ascending">
                                                                    Organization name</th>
                                                                <th class="min-w-70px sorting_disabled" rowspan="1"
                                                                    colspan="1" aria-label="Actions">Actions
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody class="fw-semibold text-gray-600">
                                                            <!-- <tr class="odd">

                                                                <td class="pe-0">
                                                                    <span class="fw-bold">04902009</span>
                                                                </td>
                                                                <td class="pe-0" data-order="10">
                                                                    <span class="fw-bold ms-3">10</span>
                                                                </td>
                                                                <td class="text-end">
                                                                    <a href="#"
                                                                        class="btn btn-sm btn-light btn-flex btn-center btn-active-light-primary"
                                                                        data-kt-menu-trigger="click"
                                                                        data-kt-menu-placement="bottom-end">
                                                                        Actions
                                                                        <i class="ki-duotone ki-down fs-5 ms-1"></i>
                                                                    </a>
                                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-semibold fs-7 w-125px py-4"
                                                                        data-kt-menu="true">
                                                                        <div class="menu-item px-3">
                                                                            <a href="#" class="menu-link px-3"
                                                                                data-kt-ecommerce-product-filter="delete_row">
                                                                                Delete
                                                                            </a>
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                            </tr> -->

                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="fv-row w-100 flex-md-root">

                                        </div>
                                    </div>
                                </div>
                                <div class="separator border-secondary my-10"></div>
                                <h2 class="mb-10">Certification Details</h2>
                                <div class="mb-5 fv-row">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                            <label class="required form-label">Name of the Program/Course:</label>
                                            <input type="text" name="program_name" id="program_name"
                                                class="form-control mb-2"
                                                placeholder="Enter program/course name here" />
                                            <div class="text-muted fs-7">Please enter the name of the program or course
                                                that the attendee completed or participated in.</div>
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                        <div class="fv-row w-100 flex-md-root">

                                        </div>
                                    </div>
                                </div>
                                <div class="mb-5 fv-row">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                            <label class="required form-label">Date of Event/Completion:</label>
                                            <input type="date" name="date_event" id="date_event"
                                                class="form-control mb-2" placeholder="Select or enter date here" />
                                            <div class="text-muted fs-7">Please select the date from a calendar or enter
                                                the date in the format</div>
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                        <div class="fv-row w-100 flex-md-root">

                                        </div>
                                    </div>
                                </div>
                                <div class="mb-5 fv-row mt-10">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                            <label class="required form-label">Title of Certificate:</label>
                                            <select name="certificate_title_option" id="certificate_title_option"
                                                class="form-select"
                                                data-placeholder="Please select the appropriate title for the certificate from the dropdown menu."
                                                onchange="certificate_selection(event)">
                                                <option disabled selected>Please select the appropriate title for
                                                    the
                                                    certificate from the dropdown menu.</option>
                                                <option value="c1" id="certificate_title" name="certificate_title">
                                                    Certificate of
                                                    Attendance</option>
                                                <option value="c2" id="certificate_title" name="certificate_title">
                                                    Certificate of Completion</option>
                                                <option value="c3" id="certificate_title" name="certificate_title">
                                                    Certificate of
                                                    Participation</option>
                                                <option value="c4" id="certificate_title" name="certificate_title">
                                                    Certificate of
                                                    Appreciation</option>
                                            </select>
                                            <div class="text-muted fs-7">e.g Certificate of Attendance / Completion /
                                                Participation / Appreciation</div>
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                        <div class="fv-row w-100 flex-md-root"></div>
                                    </div>
                                </div>
                                <div class="mb-5 fv-row">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                            <label class="required form-label">Opening phrase or sentence:</label>
                                            <textarea type="text" name="opening_phrase" id="opening_phrase"
                                                class="form-control mb-2"
                                                placeholder="e.g. This certificate is awarded to..."></textarea>
                                            <div class="text-muted fs-7">Please enter the opening phrase or sentence for
                                                the certificate, which will appear at the top of the certificate.
                                            </div>
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                        <div class="fv-row w-100 flex-md-root"></div>
                                    </div>
                                </div>
                                <div class="mb-5 fv-row">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                            <label class="required form-label">Certification Statement:</label>
                                            <textarea type="text" name="certificate_statement"
                                                id="certificate_statement" class="form-control mb-2"
                                                placeholder="For successfully completing the XYZ training program..."></textarea>
                                            <div class="text-muted fs-7">Please enter the certification statement for
                                                the certificate, which will describe the achievement or accomplishment
                                                for which the certificate is being awarded.</div>
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                        <div class="fv-row w-100 flex-md-root"></div>
                                    </div>
                                </div>
                                <div class="mb-5 fv-row">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                            <label class="required form-label">Brand:</label>
                                            <select name="brand_options" id="brand_options" class="form-select"
                                                data-placeholder="Please select the brand associated with the certificate.">
                                                <option value="bitdefender" id="brand" name="brand">Bitdefender
                                                </option>
                                                <option value="sonicwall" id="brand" name="brand">SonicWall</option>
                                                <option value="prtg" id="brand" name="brand">PRTG Network Monitor
                                                </option>
                                                <option value="faronics" id="brand" name="brand">Faronics</option>
                                                <option value="secpoint" id="brand" name="brand">SecPoint</option>
                                                <option value="easynac" id="brand" name="brand">Easy NAC</option>
                                                <option value="teamviewer" id="brand" name="brand">TeamViewer
                                                </option>
                                                <option value="veriato" id="brand" name="brand">Veriato</option>
                                                <option value="rdx" id="brand" name="brand">RDX Tandberg Data
                                                </option>
                                                <option value="activeimage" id="brand" name="brand">ActiveImage
                                                    Protector</option>
                                                <option value="axigen" id="brand" name="brand">Axigen</option>
                                                <option value="infosec" id="brand" name="brand">Infosec</option>
                                            </select>
                                            <div class="text-muted fs-7">e.g. Bitdefender, SonicWall, PRTG Network
                                                Monitor
                                            </div>
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                        <div class="fv-row w-100 flex-md-root"></div>
                                    </div>
                                </div>
                                <div class="mb-5 fv-row">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                            <label class="required form-label">Date of Issuance:</label>
                                            <input type="date" name="date_issue" id="date_issue"
                                                class="form-control mb-2" />
                                            <div class="text-muted fs-7">Please enter the date when the certificate will
                                                be issued.
                                            </div>
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                        <div class="fv-row w-100 flex-md-root"></div>
                                    </div>
                                </div>
                                <div class="mb-5 fv-row">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                            <label class="required form-label">Upload Certificate Template with
                                                Signature:</label>
                                            <input type="file" name="certificate_template" id="certificate_template"
                                                class="form-control mb-2 disabled"
                                                placeholder="Please upload the certificate template that includes the appropriate signature."
                                                disabled />
                                            <div class="text-muted fs-7">Click <a href="" class="link-primary">here</a>
                                                on how to obtain the template
                                            </div>
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                        <div class="fv-row w-100 flex-md-root"></div>
                                    </div>
                                </div>
                                <div class="mb-5 fv-row">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                            <label class="required form-label">Certificate Issuer Full Name</label>
                                            <input type="text" name="ci_fullname" id="ci_fullname"
                                                class="form-control mb-2"
                                                placeholder="Please enter the full name of the certificate issuer, which will appear on the certificate."
                                                value="Joseph B. Logro" />
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                        <div class="fv-row w-100 flex-md-root"><label class="required form-label">
                                                Position</label>
                                            <input type="text" name="ci_position" id="ci_position"
                                                class="form-control mb-2"
                                                placeholder="Please enter the position of the certificate issuer, which will appear below the signature on the certificate."
                                                value="General Manager" />
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-5 fv-row">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container">
                                            <label class="required form-label">Principal Issuer Full Name:
                                            </label>
                                            <input type="text" name="pi_fullname" id="pi_fullname"
                                                class="form-control mb-2"
                                                placeholder="Enter the full name of the principal issuer here"
                                                value="" />
                                            <div class="text-muted fs-7">Please enter the full name of the principal
                                                issuer, who will sign the certificate.</div>
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                        <div class="fv-row w-100 flex-md-root"><label class="required form-label">
                                                Position</label>
                                            <input type="text" name="pi_position" id="pi_position"
                                                class="form-control mb-2"
                                                placeholder="Enter the position of the principal issuer here"
                                                value="" />
                                            <div class="text-muted fs-7">Please enter the position of the principal
                                                issuer, which will appear below the signature on the certificate. e.g.
                                                Training Manager, Program Director
                                            </div>
                                            <div class="fv-plugins-message-container invalid-feedback"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-5 fv-row">
                                    <div class="d-flex flex-wrap gap-5">
                                        <div class="fv-row w-100 flex-md-root fv-plugins-icon-container"></div>
                                        <div class="fv-row w-100 flex-md-root"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end">
                        <button type="reset" class="btn btn-light me-5">Clear All</button>
                        <button class="btn btn-primary  me-5" id="certificate-submit" name="certificate-submit">
                            <!--  onclick="multiple_pdf()"  -->
                            <span class="indicator-label"> Generate Certificate</span>
                            <span class="indicator-progress">
                                Please wait...
                                <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                            </span>
                        </button>
                        <button class="btn btn-primary  me-5" id="generate-pdf" name="generate-pdf">
                            <span class="indicator-label">Generate</span>
                            <span class="indicator-progress">
                                Please wait...
                                <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                            </span>
                        </button>
                        <button class="btn btn-primary  me-5" id="multi-generate-pdf" name="multi-generate-pdf">
                            <span class="indicator-label">Multi-Generate</span>
                            <span class="indicator-progress">
                                Please wait...
                                <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="assets/plugins/global/plugins.bundle.js"></script>
    <script src="assets/js/scripts.bundle.js "></script>
    <link href="assets/plugins/custom/datatables/datatables.bundle.css" rel="stylesheet" type="text/css" />
    <script src="assets/plugins/custom/datatables/datatables.bundle.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/polyfills.umd.js"></script>
    <script src="https://unpkg.com/ulid@2.3.0/dist/index.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.14/jspdf.plugin.autotable.min.js"></script>


    <script>
        function certificate_selection(e) {
            var opening_phrase = document.getElementById("opening_phrase");
            var certificate_statement = document.getElementById("certificate_statement");
            var program_name = document.getElementById("program_name").value;
            var date_event = document.getElementById("date_event").value;

            const date1 = new Date(date_event);
            const options = {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            };
            const formattedDate = date1.toLocaleDateString('en-US', options);

            if (e.target.value == "c1") {
                opening_phrase.value = "This is to certify that:";
                certificate_statement.value = "has attended the [Name of the event, workshop, or training program] " + program_name + " held at [Name of the organization] on [Date of the event]" + formattedDate;
            } else if (e.target.value == "c2") {
                opening_phrase.value = "This is to certify that:";
                certificate_statement.value = "has successfully completed the [Name of the program or course]  " + program_name + " offered by [Name of the organization] on [Date of completion]" + formattedDate;
            } else if (e.target.value == "c3") {
                opening_phrase.value = "This is to certify that:";
                certificate_statement.value = "has participated in the [Name of the event, workshop, or program] " + program_name + " held at [Name of the organization] on [Date of the event]" + formattedDate;
            } else if (e.target.value == "c4") {
                opening_phrase.value = "This is to express our deepest appreciation to:";
                certificate_statement.value = "for their outstanding contribution, dedication, and support to [Name of the event, cause, or organization]" + program_name;
            }

        }
    </script>
    <script>
        "use strict";


        function getDaySuffix(day) {
            if (day >= 11 && day <= 13) {
                return "th";
            }
            switch (day % 10) {
                case 1:
                    return "st";
                case 2:
                    return "nd";
                case 3:
                    return "rd";
                default:
                    return "th";
            }
        }


        function generate_data() {
            var jsPDF = window.jspdf.jsPDF;

            ///Variables
            var attendee_name = document.getElementById("attendee_name");
            var organization = document.getElementById("organization");
            var certificate_title_option = document.getElementById("certificate_title_option");
            var certificate_title;
            var opening_phrase = document.getElementById("opening_phrase");
            var certificate_statement = document.getElementById("certificate_statement").value;

            if (certificate_title_option.value == "c1") {
                certificate_title = "Certificate of Attendance";
            } else if (certificate_title_option.value == "c2") {
                certificate_title = "Certificate of Completion";
            } else if (certificate_title_option.value == "c3") {
                certificate_title = "Certificate of Participation";
            } else if (certificate_title_option.value == "c4") {
                certificate_title = "Certificate of Appreciation";
            } else {

            }

            var brand_options = document.getElementById("brand_options");
            var brand_selected = brand_options.value;
            var brand_img;

            if (brand_selected == "bitdefender") {
                brand_img = 'bitdefender_logo.png';
            } else if (brand_selected == "sonicwall") {
                brand_img = 'sonicwall_logo.png';
            } else if (brand_selected == "prtg") {
                brand_img = 'prtg_logo.png';
            } else if (brand_selected == "faronics") {
                brand_img = 'faronics_logo.png';
            } else if (brand_selected == "secpoint") {
                brand_img = 'secpoint_logo.png';
            } else if (brand_selected == "easynac") {
                brand_img = 'easynac_logo.png';
            } else if (brand_selected == "teamviewer") {
                brand_img = 'teamviewer_logo.png';
            } else if (brand_selected == "veriato") {
                brand_img = 'veriato_logo.png';
            } else if (brand_selected == "rdx") {
                brand_img = 'rdx_logo.png';
            } else if (brand_selected == "activeimage") {
                brand_img = 'active_image.png';
            } else if (brand_selected == "axigen") {
                brand_img = 'axigen_logo.png';
            } else if (brand_selected == "infosec") {
                brand_img = 'infosec_logo.png';
            } else {

            }

            const date_issue = document.getElementById("date_issue").value;
            const date = new Date(date_issue);
            const year = date.getFullYear();
            const month = date.toLocaleString('default', {
                month: 'long'
            });
            const day = date.getDate();



            var ci_fullname = document.getElementById("ci_fullname");
            var ci_position = document.getElementById("ci_position");
            var pi_fullname = document.getElementById("pi_fullname");
            var pi_position = document.getElementById("pi_position");

            var doc = new jsPDF('landscape');
            const x = doc.internal.pageSize.getWidth() / 2;
            const y = doc.internal.pageSize.getHeight() / 2;
            var imgDatasample = "A4-landscape.png";

            doc.addFont("Poppins-SemiBold.ttf", "Poppins", "Semibold");
            doc.addFont("SourceSansPro-Regular.ttf", "Source Sans Pro", "normal");

            doc.addImage(imgDatasample, 'PNG', 0, 0, 0, 210);

            doc.addImage(brand_img, 'PNG', 224.74, 33, 40, 10);


            doc.setFont("Poppins", "Semibold");
            doc.setFontSize(36);
            doc.setTextColor(253, 154, 36);
            const text = certificate_title;
            const textWidth = doc.getTextWidth(text);
            const textHeight = doc.getTextDimensions(text).h;
            doc.text(certificate_title, x, 66, {
                align: 'center',
                lineHeightFactor: 1.5,
            });
            doc.setFontSize(10.5);
            doc.setTextColor(0, 0, 0);
            doc.setFont("Source Sans Pro", "normal");
            const text1 = opening_phrase.value;
            doc.text(text1, x, 80, {
                align: 'center',
                lineHeightFactor: 1.5,
            });
            doc.setFont("Poppins", "Semibold");
            doc.setFontSize(30);
            doc.setTextColor(253, 154, 36);
            const text2 = attendee_name.value;
            doc.text(text2, x, 98, {
                align: 'center',
                lineHeightFactor: 1.5,
            });
            doc.setDrawColor(253, 154, 36);
            doc.setLineWidth(0.5);
            doc.line(x - 5 - doc.getTextWidth(text2) / 2, 102, x + 5 + doc.getTextWidth(text2) / 2, 102);

            doc.setFont("Poppins", "Semibold");
            doc.setFontSize(10.5);
            doc.setTextColor(0, 0, 0);
            const text3 = organization_affiliation.value;
            doc.text(text3, x, 110, {
                align: 'center',
                lineHeightFactor: 1.5,
            });
            doc.setFont("Source Sans Pro", "normal");
            doc.setFontSize(10.5);
            doc.setTextColor(0, 0, 0);
            doc.text(certificate_statement, x, 126, {
                align: 'center',
                maxWidth: 120,
                lineHeightFactor: 1.5,
            });
            doc.setFont("Poppins", "Semibold");
            doc.setFontSize(10.5);
            doc.setTextColor(0, 0, 0);
            const suffix = getDaySuffix(day);
            const text5 = "Given this " + day + suffix + " day of " + month + " " + year;
            doc.text(text5, x, 150, {
                align: 'center',
                maxWidth: 120,
                lineHeightFactor: 1.5,
            }); //138

            doc.setFont("Poppins", "Semibold");
            doc.setFontSize(10.5);
            doc.text(ci_fullname.value, 36, 177, {
                lineHeightFactor: 1.3,
            });
            doc.setFont("Source Sans Pro", "normal");
            doc.text("\n" + ci_position.value, 36, 177, {
                lineHeightFactor: 1.3,
            });

            doc.setFont("Poppins", "Semibold");
            doc.setFontSize(10.5);
            doc.text(pi_fullname.value, 216, 177, {
                lineHeightFactor: 1.3,
            });
            doc.setFont("Source Sans Pro", "normal");
            doc.text("\n" + pi_position.value, 216, 177, {
                lineHeightFactor: 1.3,
            });

            // doc.addImage(imgDatasample, 'PNG', 0, 0, 0, 300);
            // Add the selected brands logos

            doc.save(ULID.ulid() + " - " + attendee_name.value + ".pdf");
        }

        // Class definition
        var CertificateGenerator = function () {
            // Private variables
            var form = document.getElementById('certificate-form');
            var submitButton = document.getElementById('certificate-submit');
            var validation;

            // Private functions
            var initValidation = function () {
                // Init form validation rules. For more info check the FormValidation plugin's official documentation:https://formvalidation.io/
                validation = FormValidation.formValidation(
                    form, {
                    fields: {
                        attendee_name: {
                            validators: {
                                notEmpty: {
                                    message: "Attendee Name is required"
                                }
                            }
                        },
                        organization: {
                            validators: {
                                notEmpty: {
                                    message: "Organization is required"
                                }
                            }
                        },
                        opening_phrase: {
                            validators: {
                                notEmpty: {
                                    message: "Opening phrase or sentence is required"
                                }
                            }
                        },
                        certificate_statement: {
                            validators: {
                                notEmpty: {
                                    message: "Certification Statement is required"
                                }
                            }
                        },
                        certificate_title_option: {
                            validators: {
                                notEmpty: {
                                    message: "Brands is required"
                                }
                            }
                        },
                        brand_options: {
                            validators: {
                                notEmpty: {
                                    message: "Brands is required"
                                }
                            }
                        },
                        ci_fullname: {
                            validators: {
                                notEmpty: {
                                    message: "Certificate Issuer Full Nameis required"
                                }
                            }
                        },
                        ci_position: {
                            validators: {
                                notEmpty: {
                                    message: "Certificate Issuer Position is required"
                                }
                            }
                        },
                        pi_fullname: {
                            validators: {
                                notEmpty: {
                                    message: "Principal Full Nameis required"
                                }
                            }
                        },
                        pi_position: {
                            validators: {
                                notEmpty: {
                                    message: "Principal Position is required"
                                }
                            }
                        },
                        date_issue: {
                            validators: {
                                notEmpty: {
                                    message: "Date of Issuance is required"
                                }
                            }
                        },

                    },
                    plugins: {
                        trigger: new FormValidation.plugins.Trigger(),
                        submitButton: new FormValidation.plugins.SubmitButton(),
                        // defaultSubmit: new FormValidation.plugins.DefaultSubmit(), // Uncomment this line to enable normal button submit after form validation
                        bootstrap: new FormValidation.plugins.Bootstrap5({
                            rowSelector: '.fv-row',
                            eleInvalidClass: '',
                            eleValidClass: ''
                        })
                    }
                }
                );

            }

            var handleForm = function () {
                submitButton.addEventListener('click', function (e) {
                    e.preventDefault();
                    validation.validate().then(function (status) {
                        if (status == 'Valid') {
                            swal.fire({
                                text: "Thank you! Your Certificate will generate",
                                icon: "success",
                                buttonsStyling: false,
                                confirmButtonText: "Ok, got it!",
                                customClass: {
                                    confirmButton: "btn fw-bold btn-light-primary"
                                }

                            });
                            generate_data();
                        } else {
                            swal.fire({
                                text: "Sorry, looks like there are some errors detected, please try again.",
                                icon: "error",
                                buttonsStyling: false,
                                confirmButtonText: "Ok, got it!",
                                customClass: {
                                    confirmButton: "btn fw-bold btn-light-primary"
                                }
                            });
                        }
                    });
                });
            }

            var table;

            var test = function () {
                var jsPDF = window.jspdf.jsPDF;

                // Initialize jsPDF
                const doc = new jsPDF();

                // Initialize DataTable
                table = $('#kt_ecommerce_products_table').DataTable({
                    columns: [{
                        title: 'ID'
                    }, {
                        title: 'Name'
                    }, {
                        title: 'Organization Name'
                    }, {
                        title: 'Actions'
                    }]
                });



                let idCounter = 1;

                function generatePDF() {
                    // Set font size and style
                    doc.setFontSize(20);
                    doc.setFont('helvetica', 'bold');

                    // Loop over each row of data
                    const data = table.data().toArray();
                    data.forEach((row) => {
                        // Add name to PDF
                        doc.text(`Name: ${row[1]}`, 20, 20);

                        // Add organization name to PDF
                        doc.text(`Organization Name: ${row[2]}`, 20, 30);

                        // Add page break
                        doc.addPage();
                    });

                    // Save PDF file with unique name
                    doc.save(`file.pdf`);
                }

                function multiple_pdf() {
                    // Initialize jsPDF
                    var jsPDF = window.jspdf.jsPDF;
                    // Initialize jsPDF
                    const doc = new jsPDF('landscape');

                    function generatePDFsingle(data) {
                        // Initialize jsPDF
                        const doc = new jsPDF();

                        // Set font size and style
                        doc.setFontSize(20);
                        doc.setFont('helvetica', 'bold');

                        // Add name to PDF
                        doc.text(`Name: ${data[1]}`, 20, 20);
                        // Save PDF file with unique name
                        doc.save(`file_${data[0]}.pdf`);
                    }

                    // Loop over each row of data and generate a PDF for each row
                    const data = table.data().toArray();
                    console.log(data);
                    data.forEach((row) => {
                        generatePDFsingle(row);
                    });
                }

                // Event listener for generate PDF button
                document.getElementById('generate-pdf').addEventListener('click', (e) => {
                    e.preventDefault();
                    generatePDF();
                });

                // Event listener for generate PDF button
                document.getElementById('multi-generate-pdf').addEventListener('click', (e) => {
                    e.preventDefault();
                    multiple_pdf();
                });
                // Event listener for add row button
                document.getElementById('add-row').addEventListener('click', (event) => {
                    event.preventDefault();
                    // Get input values
                    const name = document.getElementById('attendee_name').value;
                    const organization = document.getElementById('organization').value;

                    // Add row to table
                    table.row.add([idCounter++, name, organization, '<button class="btn btn-danger delete-row">Delete</button>']).draw();

                    // Update delete button click event handlers
                    const deleteButtons = document.querySelectorAll('.delete-row');
                    deleteButtons.forEach((button, index) => {
                        button.addEventListener('click', () => {
                            // Remove corresponding row from table
                            table.row(button.closest('tr')).remove().draw();

                            // Re-render PDF
                            //  generatePDF();
                        });
                    });
                });
            }

            var handleSearchDatatable = () => {
                const filterSearch = document.querySelector('[data-kt-filter="search"]');
                filterSearch.addEventListener('keyup', function (e) {
                    table.search(e.target.value).draw();
                });
            }



            // Public methods
            return {
                init: function () {
                    handleSearchDatatable();
                    initValidation();
                    handleForm();
                    test();

                }
            }
        }();

        // On document ready
        KTUtil.onDOMContentLoaded(function () {
            CertificateGenerator.init();
        });
    </script>
</body>

</html>